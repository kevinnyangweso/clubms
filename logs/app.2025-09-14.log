2025-09-14 19:12:26 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Environment variables loaded successfully
2025-09-14 19:12:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application UI launched successfully
2025-09-14 19:15:22 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Starting...
2025-09-14 19:15:39 INFO  [JavaFX Application Thread] com.zaxxer.hikari.pool.HikariPool - CMS-Pool - Added connection org.postgresql.jdbc.PgConnection@72627f48
2025-09-14 19:15:39 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Start completed.
2025-09-14 19:15:42 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Testing Excel integration...
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Found 0 learners in database
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file exists: true
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file size: 8876 bytes
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Started periodic cleanup scheduler for expired transient data
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-14 19:15:42 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook listener service initializing on port 8080
2025-09-14 19:15:43 INFO  [Thread-4] org.eclipse.jetty.util.log - Logging initialized @232465ms to org.eclipse.jetty.util.log.Slf4jLog
2025-09-14 19:15:43 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - == Spark has ignited ...
2025-09-14 19:15:43 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - >> Listening on 0.0.0.0:8080
2025-09-14 19:15:43 INFO  [Thread-4] org.eclipse.jetty.server.Server - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 21.0.7+8-LTS-245
2025-09-14 19:15:43 INFO  [Thread-4] org.eclipse.jetty.server.session - DefaultSessionIdManager workerName=node0
2025-09-14 19:15:43 INFO  [Thread-4] org.eclipse.jetty.server.session - No SessionScavenger set, using defaults
2025-09-14 19:15:43 INFO  [Thread-4] org.eclipse.jetty.server.session - node0 Scavenging every 660000ms
2025-09-14 19:15:44 INFO  [Thread-4] o.e.jetty.server.AbstractConnector - Started ServerConnector@6cb53fd8{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 19:15:44 INFO  [Thread-4] org.eclipse.jetty.server.Server - Started @233321ms
2025-09-14 19:15:44 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ”„ Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-14 19:15:44 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ“– Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:15:45 WARN  [qtp1579270704-51] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 19:15:45 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-14 19:15:45 INFO  [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook registered successfully with school server
2025-09-14 19:15:49 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ“Š Excel file has 9 rows
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ“‹ Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - âœ… Parsed 8 valid records from 8 rows
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 8 learners from Excel file
2025-09-14 19:15:51 INFO  [qtp1579270704-46] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 14 ms - Event: new_student, Admission: adm001
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-14 19:15:51 INFO  [qtp1579270704-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm002
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-14 19:15:51 INFO  [qtp1579270704-52] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm003
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-14 19:15:51 INFO  [qtp1579270704-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm004
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-14 19:15:51 INFO  [qtp1579270704-46] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm005
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-14 19:15:51 INFO  [qtp1579270704-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm006
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-14 19:15:51 INFO  [qtp1579270704-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0010
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-14 19:15:51 INFO  [qtp1579270704-46] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0011
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 8 new, 0 updated, 0 removed students
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 8 changes in database
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 8 records in database
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-14 19:15:51 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Validation: 8 valid, 0 invalid DTOs
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - === EXCEL DATA DEBUG ===
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 1: admission=adm001, name=Michael Prince, grade=Grade 2, date=2020-02-02, gender=Male
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm001, name=Michael Prince, grade=Grade 2, date=2020-02-02, gradeId=75c082f5-16ef-420e-8ca5-3635ca784401, error=null, valid=true
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 2: admission=adm002, name=John Hamisi, grade=Grade 9, date=2023-04-08, gender=Male
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm002, name=John Hamisi, grade=Grade 9, date=2023-04-08, gradeId=de75dd39-9b5a-4f2a-9f6f-2e2a73740a65, error=null, valid=true
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 3: admission=adm003, name=Nicole Prudence, grade=Creche, date=2030-04-05, gender=Female
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm003, name=Nicole Prudence, grade=Creche, date=2030-04-05, gradeId=6804fc9b-5cb1-45bb-9e10-abe8c6fd195b, error=null, valid=true
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 4: admission=adm004, name=Esther Wanja, grade=PP1, date=1990-06-06, gender=Female
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm004, name=Esther Wanja, grade=PP1, date=1990-06-06, gradeId=c25ae18d-7ec6-4de5-b349-e4980e4176a5, error=null, valid=true
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 5: admission=adm005, name=John Kimbo, grade=PP2, date=2025-06-09, gender=Male
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm005, name=John Kimbo, grade=PP2, date=2025-06-09, gradeId=a6366eec-69d9-4bbb-9c3e-c29f9b275d67, error=null, valid=true
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 6: admission=adm006, name=Amos Yegon, grade=Grade 8, date=2023-09-09, gender=Male
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm006, name=Amos Yegon, grade=Grade 8, date=2023-09-09, gradeId=499620a9-9695-4ecd-9a80-9ac576c1a882, error=null, valid=true
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 7: admission=adm0010, name=Kevin Nyangweso, grade=Grade 7, date=2018-08-16, gender=Male
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm0010, name=Kevin Nyangweso, grade=Grade 7, date=2018-08-16, gradeId=340eeac6-834d-48f0-9f57-eff401c9a203, error=null, valid=true
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 8: admission=adm0011, name=Faith Mwelela, grade=Grade 7, date=2019-12-03, gender=
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm0011, name=Faith Mwelela, grade=Grade 7, date=2019-12-03, gradeId=340eeac6-834d-48f0-9f57-eff401c9a203, error=null, valid=true
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm001: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm002: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm003: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm004: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm005: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm006: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm0010: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import learner adm0011: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 ERROR [JavaFX Application Thread] c.c.c.service.LearnerService - Batch update failed
java.sql.BatchUpdateException: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.BatchResultHandler.handleError(BatchResultHandler.java:165)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.internalExecuteBatch(PgStatement.java:896)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeBatch(PgStatement.java:936)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeBatch(PgPreparedStatement.java:1733)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyStatement.executeBatch(ProxyStatement.java:127)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeBatch(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.executeBatch(LearnerService.java:235)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.processImportBatch(LearnerService.java:149)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.importLearners(LearnerService.java:121)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.processExcelData(LearnerService.java:443)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.processChangesInDatabase(ExcelSchoolServer.java:431)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.detectChanges(ExcelSchoolServer.java:407)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelData(ExcelSchoolServer.java:212)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelDataWithRetry(ExcelSchoolServer.java:635)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:134)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:248)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:82)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: org.postgresql.util.PSQLException: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:329)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.internalExecuteBatch(PgStatement.java:893)
	... 70 common frames omitted
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Processed 8 Excel records: 0 successful, 0 failed
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService - Failed to import 8 records:
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm001: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm002: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm003: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm004: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm005: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm006: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm0010: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.service.LearnerService -   adm0011: Batch failed: Batch entry 0 INSERT INTO learners (learner_id, admission_number, full_name, grade_id,
    grade_name, school_id, date_joined_school, gender, created_at)
VALUES (('e11decba-67ee-4cd2-87e0-ed08337d4614'::uuid), ('adm001'), ('Michael Prince'), ('75c082f5-16ef-420e-8ca5-3635ca784401'::uuid), ('Grade 2'), ('9d47203f-4e54-47ac-a560-eeb277794e76'::uuid), ('2020-02-02 +03'), ('Male'), CURRENT_TIMESTAMP)
ON CONFLICT (admission_number, school_id) DO UPDATE SET
    full_name = EXCLUDED.full_name,
    grade_id = EXCLUDED.grade_id,
    grade_name = EXCLUDED.grade_name,
    date_joined_school = EXCLUDED.date_joined_school,
    gender = EXCLUDED.gender,
    is_active = TRUE,
    created_at = CASE WHEN learners.is_active = FALSE THEN CURRENT_TIMESTAMP ELSE learners.created_at END
 was aborted: ERROR: column "grade_name" of relation "learners" does not exist
  Position: 78  Call getNextException to see other errors in the batch.
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 8 changes in database
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 8 learners from Excel
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server started for file: C:/Users/user/Desktop/learners.xlsx
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Services started for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.controller.LoginController - User 'mw1' logged in successfully (userId=6748e77d-a21d-4fee-94ad-a0532bd88c68, schoolId=9d47203f-4e54-47ac-a560-eeb277794e76, role=club_coordinator)
2025-09-14 19:15:52 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-14 19:15:52 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - === OVERVIEW CONTROLLER INITIALIZATION ===
2025-09-14 19:15:52 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - âœ… School ID found: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm001
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm002
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm003
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm004
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm005
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm006
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0010
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0011
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:15:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 0 learners
2025-09-14 19:28:07 INFO  [Thread-3] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown initiated...
2025-09-14 19:28:08 INFO  [Thread-3] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown completed.
2025-09-14 19:28:53 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Environment variables loaded successfully
2025-09-14 19:28:57 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application UI launched successfully
2025-09-14 19:29:24 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Starting...
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] com.zaxxer.hikari.pool.HikariPool - CMS-Pool - Added connection org.postgresql.jdbc.PgConnection@7918f0c1
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Start completed.
2025-09-14 19:29:26 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Testing Excel integration...
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Found 0 learners in database
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file exists: true
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file size: 8876 bytes
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Started periodic cleanup scheduler for expired transient data
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-14 19:29:26 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-14 19:29:27 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook listener service initializing on port 8080
2025-09-14 19:29:27 INFO  [Thread-4] org.eclipse.jetty.util.log - Logging initialized @42311ms to org.eclipse.jetty.util.log.Slf4jLog
2025-09-14 19:29:27 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - == Spark has ignited ...
2025-09-14 19:29:27 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - >> Listening on 0.0.0.0:8080
2025-09-14 19:29:27 INFO  [Thread-4] org.eclipse.jetty.server.Server - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 21.0.7+8-LTS-245
2025-09-14 19:29:27 INFO  [Thread-4] org.eclipse.jetty.server.session - DefaultSessionIdManager workerName=node0
2025-09-14 19:29:27 INFO  [Thread-4] org.eclipse.jetty.server.session - No SessionScavenger set, using defaults
2025-09-14 19:29:27 INFO  [Thread-4] org.eclipse.jetty.server.session - node0 Scavenging every 660000ms
2025-09-14 19:29:28 INFO  [Thread-4] o.e.jetty.server.AbstractConnector - Started ServerConnector@2734a26c{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 19:29:28 INFO  [Thread-4] org.eclipse.jetty.server.Server - Started @43085ms
2025-09-14 19:29:28 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ”„ Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-14 19:29:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ“– Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:29:29 WARN  [qtp1047874698-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 19:29:29 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-14 19:29:29 INFO  [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook registered successfully with school server
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ“Š Excel file has 9 rows
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ“‹ Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - âœ… Parsed 8 valid records from 8 rows
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 8 learners from Excel file
2025-09-14 19:29:31 INFO  [qtp1047874698-45] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 6 ms - Event: new_student, Admission: adm001
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-14 19:29:31 INFO  [qtp1047874698-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm002
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-14 19:29:31 INFO  [qtp1047874698-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm003
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-14 19:29:31 INFO  [qtp1047874698-45] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm004
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-14 19:29:31 INFO  [qtp1047874698-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm005
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-14 19:29:31 INFO  [qtp1047874698-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm006
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-14 19:29:31 INFO  [qtp1047874698-45] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 2 ms - Event: new_student, Admission: adm0010
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-14 19:29:31 INFO  [qtp1047874698-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0011
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 8 new, 0 updated, 0 removed students
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 8 changes in database
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 8 records in database
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Validation: 8 valid, 0 invalid DTOs
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - === EXCEL DATA DEBUG ===
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 1: admission=adm001, name=Michael Prince, grade=Grade 2, date=2020-02-02, gender=Male
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm001, name=Michael Prince, grade=Grade 2, date=2020-02-02, gradeId=75c082f5-16ef-420e-8ca5-3635ca784401, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 2: admission=adm002, name=John Hamisi, grade=Grade 9, date=2023-04-08, gender=Male
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm002, name=John Hamisi, grade=Grade 9, date=2023-04-08, gradeId=de75dd39-9b5a-4f2a-9f6f-2e2a73740a65, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 3: admission=adm003, name=Nicole Prudence, grade=Creche, date=2030-04-05, gender=Female
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm003, name=Nicole Prudence, grade=Creche, date=2030-04-05, gradeId=6804fc9b-5cb1-45bb-9e10-abe8c6fd195b, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 4: admission=adm004, name=Esther Wanja, grade=PP1, date=1990-06-06, gender=Female
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm004, name=Esther Wanja, grade=PP1, date=1990-06-06, gradeId=c25ae18d-7ec6-4de5-b349-e4980e4176a5, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 5: admission=adm005, name=John Kimbo, grade=PP2, date=2025-06-09, gender=Male
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm005, name=John Kimbo, grade=PP2, date=2025-06-09, gradeId=a6366eec-69d9-4bbb-9c3e-c29f9b275d67, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 6: admission=adm006, name=Amos Yegon, grade=Grade 8, date=2023-09-09, gender=Male
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm006, name=Amos Yegon, grade=Grade 8, date=2023-09-09, gradeId=499620a9-9695-4ecd-9a80-9ac576c1a882, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 7: admission=adm0010, name=Kevin Nyangweso, grade=Grade 7, date=2018-08-16, gender=Male
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm0010, name=Kevin Nyangweso, grade=Grade 7, date=2018-08-16, gradeId=340eeac6-834d-48f0-9f57-eff401c9a203, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Record 8: admission=adm0011, name=Faith Mwelela, grade=Grade 7, date=2019-12-03, gender=
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService -   DTO: admission=adm0011, name=Faith Mwelela, grade=Grade 7, date=2019-12-03, gradeId=340eeac6-834d-48f0-9f57-eff401c9a203, error=null, valid=true
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Processed 8 Excel records: 8 successful, 0 failed
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 8 changes in database
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 8 learners from Excel
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server started for file: C:/Users/user/Desktop/learners.xlsx
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Services started for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 19:29:31 INFO  [JavaFX Application Thread] c.c.c.controller.LoginController - User 'mw1' logged in successfully (userId=6748e77d-a21d-4fee-94ad-a0532bd88c68, schoolId=9d47203f-4e54-47ac-a560-eeb277794e76, role=club_coordinator)
2025-09-14 19:29:31 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-14 19:29:32 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-14 19:29:32 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - === OVERVIEW CONTROLLER INITIALIZATION ===
2025-09-14 19:29:32 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - âœ… School ID found: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm001
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm002
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm003
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm004
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm005
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm006
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0010
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0011
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-14 19:29:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 8 learners
2025-09-14 19:30:14 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Manual reload triggered
2025-09-14 19:30:14 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ”„ Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:31:23 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:31:24 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:31:24 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:31:25 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:31:25 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:31:26 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:33:36 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:33:37 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:33:37 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:33:38 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:33:38 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:33:39 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:35:07 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:35:08 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:35:08 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:35:09 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:35:09 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:35:10 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:39:50 INFO  [Thread-3] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown initiated...
2025-09-14 19:42:49 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Environment variables loaded successfully
2025-09-14 19:42:58 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application UI launched successfully
2025-09-14 19:43:19 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Starting...
2025-09-14 19:43:28 INFO  [JavaFX Application Thread] com.zaxxer.hikari.pool.HikariPool - CMS-Pool - Added connection org.postgresql.jdbc.PgConnection@4e1b9013
2025-09-14 19:43:28 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Start completed.
2025-09-14 19:43:30 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 19:43:30 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-14 19:43:30 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Testing Excel integration...
2025-09-14 19:43:30 ERROR [JavaFX Application Thread] c.c.c.service.LearnerService - Error fetching learners for school: 9d47203f-4e54-47ac-a560-eeb277794e76
org.postgresql.util.PSQLException: The column name grade_name was not found in this ResultSet.
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgResultSet.findColumn(PgResultSet.java:3085)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgResultSet.getString(PgResultSet.java:2921)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyResultSet.getString(HikariProxyResultSet.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.mapResultSetToLearner(LearnerService.java:406)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.getAllLearnersForSchool(LearnerService.java:390)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.testExcelIntegration(Main.java:91)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:77)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-14 19:43:30 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Found 0 learners in database
2025-09-14 19:43:30 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file exists: true
2025-09-14 19:43:30 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file size: 8883 bytes
2025-09-14 19:43:30 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Started periodic cleanup scheduler for expired transient data
2025-09-14 19:43:31 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-14 19:43:31 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-14 19:43:31 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook listener service initializing on port 8080
2025-09-14 19:43:32 INFO  [Thread-4] org.eclipse.jetty.util.log - Logging initialized @63109ms to org.eclipse.jetty.util.log.Slf4jLog
2025-09-14 19:43:33 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - == Spark has ignited ...
2025-09-14 19:43:33 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - >> Listening on 0.0.0.0:8080
2025-09-14 19:43:33 INFO  [Thread-4] org.eclipse.jetty.server.Server - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 21.0.7+8-LTS-245
2025-09-14 19:43:34 INFO  [Thread-4] org.eclipse.jetty.server.session - DefaultSessionIdManager workerName=node0
2025-09-14 19:43:34 INFO  [Thread-4] org.eclipse.jetty.server.session - No SessionScavenger set, using defaults
2025-09-14 19:43:34 INFO  [Thread-4] org.eclipse.jetty.server.session - node0 Scavenging every 660000ms
2025-09-14 19:43:34 INFO  [Thread-4] o.e.jetty.server.AbstractConnector - Started ServerConnector@52c8b6db{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 19:43:34 INFO  [Thread-4] org.eclipse.jetty.server.Server - Started @65344ms
2025-09-14 19:43:34 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ”„ Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server started for file: C:/Users/user/Desktop/learners.xlsx
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Services started for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 19:43:34 INFO  [JavaFX Application Thread] c.c.c.controller.LoginController - User 'mw1' logged in successfully (userId=6748e77d-a21d-4fee-94ad-a0532bd88c68, schoolId=9d47203f-4e54-47ac-a560-eeb277794e76, role=club_coordinator)
2025-09-14 19:43:34 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-14 19:43:34 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-14 19:43:35 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - === OVERVIEW CONTROLLER INITIALIZATION ===
2025-09-14 19:43:35 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - âœ… School ID found: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 19:43:35 WARN  [qtp1710165891-53] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 19:43:35 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-14 19:43:35 INFO  [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook registered successfully with school server
2025-09-14 19:44:18 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:44:23 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:44:23 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:44:28 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:44:28 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 19:44:33 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 19:59:30 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 19:59:47 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application shutdown initiated
2025-09-14 19:59:54 WARN  [qtp1710165891-61] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 19:59:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Successfully unregistered webhook from school server
2025-09-14 19:59:55 INFO  [Thread-13] s.e.jetty.EmbeddedJettyServer - >>> Spark shutting down ...
2025-09-14 20:00:00 INFO  [Thread-13] o.e.jetty.server.AbstractConnector - Stopped ServerConnector@52c8b6db{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 20:00:00 INFO  [Thread-13] org.eclipse.jetty.server.session - node0 Stopped scavenging
2025-09-14 20:00:01 INFO  [Thread-13] s.e.jetty.EmbeddedJettyServer - done
2025-09-14 20:00:01 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook service stopped
2025-09-14 20:00:01 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Shutting down cleanup scheduler...
2025-09-14 20:00:01 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server stopped gracefully
2025-09-14 20:00:01 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server stopped
2025-09-14 20:00:01 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 20:00:01 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 20:00:02 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown initiated...
2025-09-14 20:00:02 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown completed.
2025-09-14 20:00:02 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application stopped successfully
2025-09-14 20:24:40 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Environment variables loaded successfully
2025-09-14 20:24:58 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application UI launched successfully
2025-09-14 20:26:23 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Starting...
2025-09-14 20:26:27 INFO  [JavaFX Application Thread] com.zaxxer.hikari.pool.HikariPool - CMS-Pool - Added connection org.postgresql.jdbc.PgConnection@19b1ab65
2025-09-14 20:26:27 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Start completed.
2025-09-14 20:26:28 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 20:26:28 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-14 20:26:28 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Testing Excel integration...
2025-09-14 20:26:29 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Found 8 learners in database
2025-09-14 20:26:29 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file exists: true
2025-09-14 20:26:29 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file size: 8883 bytes
2025-09-14 20:26:29 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Started periodic cleanup scheduler for expired transient data
2025-09-14 20:26:29 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-14 20:26:29 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-14 20:26:29 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook listener service initializing on port 8080
2025-09-14 20:26:29 INFO  [Thread-4] org.eclipse.jetty.util.log - Logging initialized @139973ms to org.eclipse.jetty.util.log.Slf4jLog
2025-09-14 20:26:30 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - == Spark has ignited ...
2025-09-14 20:26:30 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - >> Listening on 0.0.0.0:8080
2025-09-14 20:26:30 INFO  [Thread-4] org.eclipse.jetty.server.Server - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 21.0.7+8-LTS-245
2025-09-14 20:26:31 INFO  [Thread-4] org.eclipse.jetty.server.session - DefaultSessionIdManager workerName=node0
2025-09-14 20:26:31 INFO  [Thread-4] org.eclipse.jetty.server.session - No SessionScavenger set, using defaults
2025-09-14 20:26:31 INFO  [Thread-4] org.eclipse.jetty.server.session - node0 Scavenging every 600000ms
2025-09-14 20:26:31 INFO  [Thread-4] o.e.jetty.server.AbstractConnector - Started ServerConnector@591e5255{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 20:26:31 INFO  [Thread-4] org.eclipse.jetty.server.Server - Started @141813ms
2025-09-14 20:26:31 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ”„ Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server started for file: C:/Users/user/Desktop/learners.xlsx
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Services started for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.controller.LoginController - User 'mw1' logged in successfully (userId=6748e77d-a21d-4fee-94ad-a0532bd88c68, schoolId=9d47203f-4e54-47ac-a560-eeb277794e76, role=club_coordinator)
2025-09-14 20:26:31 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-14 20:26:31 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - === OVERVIEW CONTROLLER INITIALIZATION ===
2025-09-14 20:26:31 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - âœ… School ID found: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 20:26:32 WARN  [qtp854888793-53] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 20:26:32 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-14 20:26:32 INFO  [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook registered successfully with school server
2025-09-14 20:27:05 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:27:10 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:27:10 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:27:15 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:27:15 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:27:20 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:46:29 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application shutdown initiated
2025-09-14 20:46:31 WARN  [qtp854888793-61] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 20:46:31 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Successfully unregistered webhook from school server
2025-09-14 20:46:31 INFO  [Thread-13] s.e.jetty.EmbeddedJettyServer - >>> Spark shutting down ...
2025-09-14 20:46:31 INFO  [Thread-13] o.e.jetty.server.AbstractConnector - Stopped ServerConnector@591e5255{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 20:46:31 INFO  [Thread-13] org.eclipse.jetty.server.session - node0 Stopped scavenging
2025-09-14 20:46:31 INFO  [Thread-13] s.e.jetty.EmbeddedJettyServer - done
2025-09-14 20:46:31 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook service stopped
2025-09-14 20:46:31 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Shutting down cleanup scheduler...
2025-09-14 20:46:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server stopped gracefully
2025-09-14 20:46:31 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server stopped
2025-09-14 20:46:31 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 20:46:31 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 20:46:32 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown initiated...
2025-09-14 20:46:32 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown completed.
2025-09-14 20:46:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application stopped successfully
2025-09-14 20:51:18 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Environment variables loaded successfully
2025-09-14 20:51:23 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application UI launched successfully
2025-09-14 20:51:40 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Starting...
2025-09-14 20:51:46 INFO  [JavaFX Application Thread] com.zaxxer.hikari.pool.HikariPool - CMS-Pool - Added connection org.postgresql.jdbc.PgConnection@14857585
2025-09-14 20:51:46 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Start completed.
2025-09-14 20:51:48 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Testing Excel integration...
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Found 8 learners in database
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file exists: true
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file size: 8883 bytes
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Started periodic cleanup scheduler for expired transient data
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-14 20:51:48 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook listener service initializing on port 8080
2025-09-14 20:51:49 INFO  [Thread-4] org.eclipse.jetty.util.log - Logging initialized @44809ms to org.eclipse.jetty.util.log.Slf4jLog
2025-09-14 20:51:50 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - == Spark has ignited ...
2025-09-14 20:51:50 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - >> Listening on 0.0.0.0:8080
2025-09-14 20:51:51 INFO  [Thread-4] org.eclipse.jetty.server.Server - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 21.0.7+8-LTS-245
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ðŸ”„ Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server started for file: C:/Users/user/Desktop/learners.xlsx
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Services started for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.controller.LoginController - User 'mw1' logged in successfully (userId=6748e77d-a21d-4fee-94ad-a0532bd88c68, schoolId=9d47203f-4e54-47ac-a560-eeb277794e76, role=club_coordinator)
2025-09-14 20:51:51 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-14 20:51:51 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-14 20:51:51 INFO  [Thread-4] org.eclipse.jetty.server.session - DefaultSessionIdManager workerName=node0
2025-09-14 20:51:51 INFO  [Thread-4] org.eclipse.jetty.server.session - No SessionScavenger set, using defaults
2025-09-14 20:51:51 INFO  [Thread-4] org.eclipse.jetty.server.session - node0 Scavenging every 600000ms
2025-09-14 20:51:51 INFO  [Thread-4] o.e.jetty.server.AbstractConnector - Started ServerConnector@3588bfe4{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 20:51:51 INFO  [Thread-4] org.eclipse.jetty.server.Server - Started @46504ms
2025-09-14 20:51:51 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - === OVERVIEW CONTROLLER INITIALIZATION ===
2025-09-14 20:51:51 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - âœ… School ID found: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 20:51:52 WARN  [qtp459504361-53] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 20:51:52 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-14 20:51:52 INFO  [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook registered successfully with school server
2025-09-14 20:53:01 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:53:06 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:53:06 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:53:11 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:53:11 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:53:16 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:54:26 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:54:31 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:54:31 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:54:36 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:54:36 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 20:54:41 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File still locked after change detection, will retry on next poll
2025-09-14 20:55:57 INFO  [Thread-3] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown initiated...
2025-09-14 20:55:57 INFO  [Thread-3] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown completed.
2025-09-14 21:41:29 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Environment variables loaded successfully
2025-09-14 21:41:37 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application UI launched successfully
2025-09-14 21:41:55 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Starting...
2025-09-14 21:42:06 INFO  [JavaFX Application Thread] com.zaxxer.hikari.pool.HikariPool - CMS-Pool - Added connection org.postgresql.jdbc.PgConnection@19b1ab65
2025-09-14 21:42:06 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Start completed.
2025-09-14 21:42:11 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-14 21:42:11 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-14 21:42:11 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Testing Excel integration...
2025-09-14 21:42:14 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Found 8 learners in database
2025-09-14 21:42:14 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file exists: true
2025-09-14 21:42:14 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file size: 8939 bytes
2025-09-14 21:42:14 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Started periodic cleanup scheduler for expired transient data
2025-09-14 21:42:15 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-14 21:42:15 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-14 21:42:15 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook listener service initializing on port 8080
2025-09-14 21:42:17 INFO  [Thread-4] org.eclipse.jetty.util.log - Logging initialized @65839ms to org.eclipse.jetty.util.log.Slf4jLog
2025-09-14 21:42:21 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - == Spark has ignited ...
2025-09-14 21:42:21 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - >> Listening on 0.0.0.0:8080
2025-09-14 21:42:21 INFO  [Thread-4] org.eclipse.jetty.server.Server - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 21.0.7+8-LTS-245
2025-09-14 21:42:21 INFO  [Thread-4] org.eclipse.jetty.server.session - DefaultSessionIdManager workerName=node0
2025-09-14 21:42:21 INFO  [Thread-4] org.eclipse.jetty.server.session - No SessionScavenger set, using defaults
2025-09-14 21:42:21 INFO  [Thread-4] org.eclipse.jetty.server.session - node0 Scavenging every 600000ms
2025-09-14 21:42:22 INFO  [Thread-4] o.e.jetty.server.AbstractConnector - Started ServerConnector@628b2b20{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-14 21:42:22 INFO  [Thread-4] org.eclipse.jetty.server.Server - Started @70687ms
2025-09-14 21:42:22 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-14 21:42:22 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-14 21:42:22 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-14 21:42:22 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-14 21:42:22 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-14 21:42:22 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-14 21:42:22 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-14 21:42:22 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 1/5
2025-09-14 21:42:23 WARN  [qtp1230836870-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-14 21:42:23 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-14 21:42:23 INFO  [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook registered successfully with school server
2025-09-14 21:42:25 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 2/5
2025-09-14 21:42:28 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 3/5
2025-09-14 21:42:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 4/5
2025-09-14 21:42:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 5/5
2025-09-14 21:42:37 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Could not load Excel file - file remains locked after 5 attempts
2025-09-14 21:42:37 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-14 21:42:37 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server started for file: C:/Users/user/Desktop/learners.xlsx
2025-09-14 21:42:37 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Services started for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 21:42:37 INFO  [JavaFX Application Thread] c.c.c.controller.LoginController - User 'mw1' logged in successfully (userId=6748e77d-a21d-4fee-94ad-a0532bd88c68, schoolId=9d47203f-4e54-47ac-a560-eeb277794e76, role=club_coordinator)
2025-09-14 21:42:37 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-14 21:42:37 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-14 21:42:37 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - === OVERVIEW CONTROLLER INITIALIZATION ===
2025-09-14 21:42:37 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - âœ… School ID found: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-14 21:43:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Manual reload triggered
2025-09-14 21:43:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 1/5
2025-09-14 21:43:07 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 21:43:09 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 2/5
2025-09-14 21:43:12 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 3/5
2025-09-14 21:43:12 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 1/5
2025-09-14 21:43:15 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 4/5
2025-09-14 21:43:15 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 2/5
2025-09-14 21:43:18 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 5/5
2025-09-14 21:43:18 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 3/5
2025-09-14 21:43:21 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Could not load Excel file - file remains locked after 5 attempts
2025-09-14 21:43:21 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 4/5
2025-09-14 21:43:24 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 5/5
2025-09-14 21:43:27 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Could not load Excel file - file remains locked after 5 attempts
2025-09-14 21:43:27 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 21:43:32 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 1/5
2025-09-14 21:43:35 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 2/5
2025-09-14 21:43:38 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 3/5
2025-09-14 21:43:41 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 4/5
2025-09-14 21:43:44 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 5/5
2025-09-14 21:43:47 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Could not load Excel file - file remains locked after 5 attempts
2025-09-14 21:43:47 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 21:43:52 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 1/5
2025-09-14 21:43:55 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 2/5
2025-09-14 21:43:58 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 3/5
2025-09-14 21:44:01 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 4/5
2025-09-14 21:44:04 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 5/5
2025-09-14 21:44:07 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Could not load Excel file - file remains locked after 5 attempts
2025-09-14 21:44:19 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 21:44:24 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 1/5
2025-09-14 21:44:27 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 2/5
2025-09-14 21:44:30 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 3/5
2025-09-14 21:44:33 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 4/5
2025-09-14 21:44:36 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - File locked, waiting for attempt 5/5
2025-09-14 21:44:39 WARN  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Could not load Excel file - file remains locked after 5 attempts
2025-09-14 21:44:39 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-14 21:44:39 INFO  [Thread-3] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown initiated...
2025-09-14 21:44:39 INFO  [Thread-3] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown completed.
