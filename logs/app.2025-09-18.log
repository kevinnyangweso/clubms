2025-09-18 06:26:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Environment variables loaded successfully
2025-09-18 06:26:54 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application UI launched successfully
2025-09-18 06:27:12 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Starting...
2025-09-18 06:27:50 INFO  [JavaFX Application Thread] com.zaxxer.hikari.pool.HikariPool - CMS-Pool - Added connection org.postgresql.jdbc.PgConnection@127c3821
2025-09-18 06:27:50 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Start completed.
2025-09-18 06:27:54 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 06:27:54 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 06:27:54 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Testing Excel integration...
2025-09-18 06:27:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Found 12 learners in database
2025-09-18 06:27:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file exists: true
2025-09-18 06:27:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel file size: 9190 bytes
2025-09-18 06:27:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Started periodic cleanup scheduler for expired transient data
2025-09-18 06:27:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 06:27:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 06:27:55 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook listener service initializing on port 8080
2025-09-18 06:27:56 INFO  [Thread-4] org.eclipse.jetty.util.log - Logging initialized @151196ms to org.eclipse.jetty.util.log.Slf4jLog
2025-09-18 06:27:58 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - == Spark has ignited ...
2025-09-18 06:27:58 INFO  [Thread-4] s.e.jetty.EmbeddedJettyServer - >> Listening on 0.0.0.0:8080
2025-09-18 06:27:59 INFO  [Thread-4] org.eclipse.jetty.server.Server - jetty-9.4.48.v20220622; built: 2022-06-21T20:42:25.880Z; git: 6b67c5719d1f4371b33655ff2d047d24e171e49a; jvm 21.0.7+8-LTS-245
2025-09-18 06:27:59 INFO  [Thread-4] org.eclipse.jetty.server.session - DefaultSessionIdManager workerName=node0
2025-09-18 06:27:59 INFO  [Thread-4] org.eclipse.jetty.server.session - No SessionScavenger set, using defaults
2025-09-18 06:27:59 INFO  [Thread-4] org.eclipse.jetty.server.session - node0 Scavenging every 660000ms
2025-09-18 06:28:00 INFO  [Thread-4] o.e.jetty.server.AbstractConnector - Started ServerConnector@1fb6fd60{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-18 06:28:00 INFO  [Thread-4] org.eclipse.jetty.server.Server - Started @155133ms
2025-09-18 06:28:00 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 06:28:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:28:06 WARN  [qtp1820235290-51] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 06:28:07 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 06:28:07 INFO  [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook registered successfully with school server
2025-09-18 06:28:23 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 15 rows
2025-09-18 06:28:23 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 14 rows (0 duplicates skipped)
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 06:28:24 INFO  [qtp1820235290-46] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 18 ms - Event: new_student, Admission: adm001
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 06:28:24 INFO  [qtp1820235290-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm002
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 06:28:24 INFO  [qtp1820235290-52] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm003
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 06:28:24 INFO  [qtp1820235290-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm004
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 06:28:24 INFO  [qtp1820235290-46] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm005
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 06:28:24 INFO  [qtp1820235290-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm006
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 06:28:24 INFO  [qtp1820235290-52] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0010
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 06:28:24 INFO  [qtp1820235290-46] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0011
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 06:28:24 INFO  [qtp1820235290-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0012
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 06:28:24 INFO  [qtp1820235290-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0013
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 06:28:24 INFO  [qtp1820235290-52] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0020
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 06:28:24 INFO  [qtp1820235290-46] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm007
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 06:28:24 INFO  [qtp1820235290-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0014
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 06:28:24 INFO  [qtp1820235290-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0022
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 14 new, 0 updated, 0 removed students, 0 duplicates ignored
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 14 changes in database
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 14 records in database
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2012-02-02'
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 06:28:24 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 14 total, 14 successful, 0 failed
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 14 changes in database
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server started for file: C:/Users/user/Desktop/learners.xlsx
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Services started for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] c.c.c.controller.LoginController - User 'mw1' logged in successfully (userId=6748e77d-a21d-4fee-94ad-a0532bd88c68, schoolId=9d47203f-4e54-47ac-a560-eeb277794e76, role=club_coordinator)
2025-09-18 06:28:25 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 06:28:25 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - === OVERVIEW CONTROLLER INITIALIZATION ===
2025-09-18 06:28:25 INFO  [JavaFX Application Thread] c.c.c.controller.OverviewController - ✅ School ID found: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm001
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm002
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm003
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm004
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm005
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm006
2025-09-18 06:28:32 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0010
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0011
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0012
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0013
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0020
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm007
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0014
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Webhook received - Event: new_student, Admission: adm0022
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshing student data due to webhook notification
2025-09-18 06:28:33 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Refreshed student data with 14 learners
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application shutdown initiated
2025-09-18 06:32:25 WARN  [qtp1820235290-65] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Successfully unregistered webhook from school server
2025-09-18 06:32:25 INFO  [Thread-14] s.e.jetty.EmbeddedJettyServer - >>> Spark shutting down ...
2025-09-18 06:32:25 INFO  [Thread-14] o.e.jetty.server.AbstractConnector - Stopped ServerConnector@1fb6fd60{HTTP/1.1, (http/1.1)}{0.0.0.0:8080}
2025-09-18 06:32:25 INFO  [Thread-14] org.eclipse.jetty.server.session - node0 Stopped scavenging
2025-09-18 06:32:25 INFO  [Thread-14] s.e.jetty.EmbeddedJettyServer - done
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook service stopped
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Shutting down cleanup scheduler...
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server stopped gracefully
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Excel School Server stopped
2025-09-18 06:32:25 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 06:32:25 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown initiated...
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] com.zaxxer.hikari.HikariDataSource - CMS-Pool - Shutdown completed.
2025-09-18 06:32:25 INFO  [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Application stopped successfully
2025-09-18 06:33:11 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 06:33:11 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 06:33:11 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 06:33:13 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 06:33:13 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 06:33:14 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 06:33:16 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:33:16 WARN  [qtp1711915237-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 06:33:16 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 15 rows
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm001: '2020-02-02'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm002: '2023-04-08'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm003: '2030-04-05'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm004: '1990-06-06'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm005: '2025-06-09'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm006: '2023-09-09'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0010: '2018-08-16'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0011: '2019-12-03'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0012: '2014-12-30'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0013: '2025-09-15'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0020: '2021-01-01'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm007: '2022-11-02'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0014: '2020-12-01'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2012-02-02'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 14 rows (0 duplicates skipped)
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm001","full_name":"Michael Prince","grade_name":"Grade 2","date_joined_school":"2020-02-02","gender":"Male","status":"","timestamp":1758166399380,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-45] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 6 ms - Event: new_student, Admission: adm001
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm001
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 06:33:19 DEBUG [qtp1711915237-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm002","full_name":"John Hamisi","grade_name":"Grade 9","date_joined_school":"2023-04-08","gender":"Male","status":"","timestamp":1758166399402,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm002
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm002
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm003","full_name":"Nicole Prudence","grade_name":"Creche","date_joined_school":"2030-04-05","gender":"Female","status":"","timestamp":1758166399412,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm003
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm003
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 06:33:19 DEBUG [qtp1711915237-41] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-41] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm004","full_name":"Esther Wanja","grade_name":"PP1","date_joined_school":"1990-06-06","gender":"Female","status":"","timestamp":1758166399420,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm004
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm004
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm005","full_name":"John Kimbo","grade_name":"PP2","date_joined_school":"2025-06-09","gender":"Male","status":"","timestamp":1758166399428,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-45] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm005
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm005
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 06:33:19 DEBUG [qtp1711915237-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm006","full_name":"Amos Yegon","grade_name":"Grade 8","date_joined_school":"2023-09-09","gender":"Male","status":"","timestamp":1758166399436,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm006
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm006
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0010","full_name":"Kevin Nyangweso","grade_name":"Grade 7","date_joined_school":"2018-08-16","gender":"Male","status":"","timestamp":1758166399443,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0010
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0010
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 06:33:19 DEBUG [qtp1711915237-41] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-41] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0011","full_name":"Faith Mwelela","grade_name":"Grade 7","date_joined_school":"2019-12-03","gender":"Female","status":"","timestamp":1758166399450,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0011
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0011
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0012","full_name":"Monica Juma","grade_name":"Grade 2","date_joined_school":"2014-12-30","gender":"Female","status":"","timestamp":1758166399459,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-45] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0012
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0012
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 06:33:19 DEBUG [qtp1711915237-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0013","full_name":"Job Guyo","grade_name":"Creche","date_joined_school":"2025-09-15","gender":"Male","status":"","timestamp":1758166399477,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0013
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0013
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0020","full_name":"Jamie Fox","grade_name":"Grade 8","date_joined_school":"2021-01-01","gender":"Male","status":"","timestamp":1758166399486,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0020
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0020
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 06:33:19 DEBUG [qtp1711915237-41] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-41] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm007","full_name":"Janet Bor","grade_name":"Grade 6","date_joined_school":"2022-11-02","gender":"Female","status":"","timestamp":1758166399493,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-41] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm007
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm007
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-45] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0014","full_name":"Ken Wamaria","grade_name":"Creche","date_joined_school":"2020-12-01","gender":"Male","status":"","timestamp":1758166399500,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-45] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0014
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0014
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:33:19 DEBUG [qtp1711915237-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0022","full_name":"Mary Ann","grade_name":"Creche","date_joined_school":"2012-02-02","gender":"Female","status":"","timestamp":1758166399508,"source":"excel-school-server"}
2025-09-18 06:33:19 INFO  [qtp1711915237-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0022
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0022
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 14 new, 0 updated, 0 removed students, 0 duplicates ignored
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 14 changes in database
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 14 records in database
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2012-02-02'
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 06:33:19 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 9' to ID: de75dd39-9b5a-4f2a-9f6f-2e2a73740a65
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP1' to ID: c25ae18d-7ec6-4de5-b349-e4980e4176a5
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP2' to ID: a6366eec-69d9-4bbb-9c3e-c29f9b275d67
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 6' to ID: db92dfdc-e9eb-466b-b919-0bbf0c65d5d7
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:33:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:33:31 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 14 total, 14 successful, 0 failed
2025-09-18 06:33:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 14 changes in database
2025-09-18 06:33:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 06:33:31 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 06:33:31 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 06:33:32 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 06:53:42 WARN  [main] c.c.c.service.ExcelSchoolServer - === TEST WARNING from Main ===
2025-09-18 06:53:42 DEBUG [main] c.c.c.service.ExcelSchoolServer - === TEST DEBUG from Main ===
2025-09-18 06:53:42 INFO  [main] c.c.c.service.ExcelSchoolServer - === TEST INFO from Main ===
2025-09-18 06:54:29 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 06:54:29 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 06:54:29 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 06:54:30 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 06:54:30 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 06:54:32 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 06:54:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:54:33 WARN  [qtp510149609-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 06:54:33 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 15 rows
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm001: '2020-02-02'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm002: '2023-04-08'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm003: '2030-04-05'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm004: '1990-06-06'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm005: '2025-06-09'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm006: '2023-09-09'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0010: '2018-08-16'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0011: '2019-12-03'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0012: '2014-12-30'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0013: '2025-09-15'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0020: '2021-01-01'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm007: '2022-11-02'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0014: '2020-12-01'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2012-02-02'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 14 rows (0 duplicates skipped)
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm001","full_name":"Michael Prince","grade_name":"Grade 2","date_joined_school":"2020-02-02","gender":"Male","status":"","timestamp":1758167676341,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 36 ms - Event: new_student, Admission: adm001
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm001
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm002","full_name":"John Hamisi","grade_name":"Grade 9","date_joined_school":"2023-04-08","gender":"Male","status":"","timestamp":1758167676392,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm002
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm002
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 06:54:36 DEBUG [qtp510149609-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm003","full_name":"Nicole Prudence","grade_name":"Creche","date_joined_school":"2030-04-05","gender":"Female","status":"","timestamp":1758167676400,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm003
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm003
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 06:54:36 DEBUG [qtp510149609-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm004","full_name":"Esther Wanja","grade_name":"PP1","date_joined_school":"1990-06-06","gender":"Female","status":"","timestamp":1758167676408,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm004
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm004
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm005","full_name":"John Kimbo","grade_name":"PP2","date_joined_school":"2025-06-09","gender":"Male","status":"","timestamp":1758167676415,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm005
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm005
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm006","full_name":"Amos Yegon","grade_name":"Grade 8","date_joined_school":"2023-09-09","gender":"Male","status":"","timestamp":1758167676422,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm006
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm006
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 06:54:36 DEBUG [qtp510149609-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0010","full_name":"Kevin Nyangweso","grade_name":"Grade 7","date_joined_school":"2018-08-16","gender":"Male","status":"","timestamp":1758167676429,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0010
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0010
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 06:54:36 DEBUG [qtp510149609-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0011","full_name":"Faith Mwelela","grade_name":"Grade 7","date_joined_school":"2019-12-03","gender":"Female","status":"","timestamp":1758167676435,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0011
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0011
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0012","full_name":"Monica Juma","grade_name":"Grade 2","date_joined_school":"2014-12-30","gender":"Female","status":"","timestamp":1758167676442,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0012
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0012
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0013","full_name":"Job Guyo","grade_name":"Creche","date_joined_school":"2025-09-15","gender":"Male","status":"","timestamp":1758167676449,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0013
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0013
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 06:54:36 DEBUG [qtp510149609-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0020","full_name":"Jamie Fox","grade_name":"Grade 8","date_joined_school":"2021-01-01","gender":"Male","status":"","timestamp":1758167676455,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0020
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0020
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 06:54:36 DEBUG [qtp510149609-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm007","full_name":"Janet Bor","grade_name":"Grade 6","date_joined_school":"2022-11-02","gender":"Female","status":"","timestamp":1758167676462,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm007
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm007
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-40] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0014","full_name":"Ken Wamaria","grade_name":"Creche","date_joined_school":"2020-12-01","gender":"Male","status":"","timestamp":1758167676469,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0014
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0014
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:54:36 DEBUG [qtp510149609-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0022","full_name":"Mary Ann","grade_name":"Creche","date_joined_school":"2012-02-02","gender":"Female","status":"","timestamp":1758167676476,"source":"excel-school-server"}
2025-09-18 06:54:36 INFO  [qtp510149609-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0022
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0022
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 14 new, 0 updated, 0 removed students, 0 duplicates ignored
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 14 changes in database
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 14 records in database
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2012-02-02'
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 9' to ID: de75dd39-9b5a-4f2a-9f6f-2e2a73740a65
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP1' to ID: c25ae18d-7ec6-4de5-b349-e4980e4176a5
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP2' to ID: a6366eec-69d9-4bbb-9c3e-c29f9b275d67
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 6' to ID: db92dfdc-e9eb-466b-b919-0bbf0c65d5d7
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:54:36 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 14 total, 14 successful, 0 failed
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 14 changes in database
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 06:54:36 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 06:54:36 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 06:54:36 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 06:55:28 WARN  [qtp510149609-51] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 06:55:28 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Successfully unregistered webhook from school server
2025-09-18 06:58:26 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 06:58:26 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 06:58:27 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 06:58:27 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 06:58:27 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 06:58:29 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 06:58:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 06:58:29 WARN  [qtp345314092-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 06:58:30 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 06:58:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 06:58:34 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm001: '2020-02-02'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm002: '2023-04-08'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm003: '2030-04-05'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm004: '1990-06-06'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm005: '2025-06-09'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm006: '2023-09-09'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0010: '2018-08-16'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0011: '2019-12-03'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0012: '2014-12-30'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0013: '2025-09-15'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0020: '2021-01-01'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm007: '2022-11-02'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0014: '2020-12-01'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2012-02-02'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2019-11-23'
2025-09-18 06:58:35 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ DUPLICATE admission number in row 16: adm0022
2025-09-18 06:58:35 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ⚠️  Found 1 duplicate records with 1 unique admission numbers: [adm0022]
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 15 rows (1 duplicates skipped)
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm001","full_name":"Michael Prince","grade_name":"Grade 2","date_joined_school":"2020-02-02","gender":"Male","status":"","timestamp":1758167915101,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 39 ms - Event: new_student, Admission: adm001
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm001
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm002","full_name":"John Hamisi","grade_name":"Grade 9","date_joined_school":"2023-04-08","gender":"Male","status":"","timestamp":1758167915157,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm002
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm002
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 06:58:35 DEBUG [qtp345314092-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm003","full_name":"Nicole Prudence","grade_name":"Creche","date_joined_school":"2030-04-05","gender":"Female","status":"","timestamp":1758167915166,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm003
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm003
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 06:58:35 DEBUG [qtp345314092-40] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-40] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm004","full_name":"Esther Wanja","grade_name":"PP1","date_joined_school":"1990-06-06","gender":"Female","status":"","timestamp":1758167915174,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm004
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm004
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm005","full_name":"John Kimbo","grade_name":"PP2","date_joined_school":"2025-06-09","gender":"Male","status":"","timestamp":1758167915184,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm005
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm005
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm006","full_name":"Amos Yegon","grade_name":"Grade 8","date_joined_school":"2023-09-09","gender":"Male","status":"","timestamp":1758167915193,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm006
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm006
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 06:58:35 DEBUG [qtp345314092-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0010","full_name":"Kevin Nyangweso","grade_name":"Grade 7","date_joined_school":"2018-08-16","gender":"Male","status":"","timestamp":1758167915201,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0010
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0010
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 06:58:35 DEBUG [qtp345314092-40] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-40] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0011","full_name":"Faith Mwelela","grade_name":"Grade 7","date_joined_school":"2019-12-03","gender":"Female","status":"","timestamp":1758167915209,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0011
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0011
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0012","full_name":"Monica Juma","grade_name":"Grade 2","date_joined_school":"2014-12-30","gender":"Female","status":"","timestamp":1758167915216,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0012
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0012
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0013","full_name":"Job Guyo","grade_name":"Creche","date_joined_school":"2025-09-15","gender":"Male","status":"","timestamp":1758167915222,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0013
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0013
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 06:58:35 DEBUG [qtp345314092-51] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-51] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0020","full_name":"Jamie Fox","grade_name":"Grade 8","date_joined_school":"2021-01-01","gender":"Male","status":"","timestamp":1758167915229,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-51] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0020
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0020
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 06:58:35 DEBUG [qtp345314092-40] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-40] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm007","full_name":"Janet Bor","grade_name":"Grade 6","date_joined_school":"2022-11-02","gender":"Female","status":"","timestamp":1758167915235,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-40] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm007
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm007
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-48] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0014","full_name":"Ken Wamaria","grade_name":"Creche","date_joined_school":"2020-12-01","gender":"Male","status":"","timestamp":1758167915242,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-48] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 0 ms - Event: new_student, Admission: adm0014
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0014
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - API key validation successful for IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0
2025-09-18 06:58:35 DEBUG [qtp345314092-50] c.c.c.service.WebhookService - Received webhook payload from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0: {"event_type":"new_student","admission_number":"adm0022","full_name":"Mary Ann","grade_name":"Creche","date_joined_school":"2012-02-02","gender":"Female","status":"","timestamp":1758167915247,"source":"excel-school-server"}
2025-09-18 06:58:35 INFO  [qtp345314092-50] c.c.c.service.WebhookService - Webhook processed successfully from IP: 127.0.0.1, User-Agent: Excel-School-Server/1.0 in 1 ms - Event: new_student, Admission: adm0022
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully sent new_student webhook for adm0022
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 14 new, 0 updated, 0 removed students, 0 duplicates ignored
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 14 changes in database
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 14 records in database
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2012-02-02'
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 9' to ID: de75dd39-9b5a-4f2a-9f6f-2e2a73740a65
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP1' to ID: c25ae18d-7ec6-4de5-b349-e4980e4176a5
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP2' to ID: a6366eec-69d9-4bbb-9c3e-c29f9b275d67
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 6' to ID: db92dfdc-e9eb-466b-b919-0bbf0c65d5d7
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:58:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 14 total, 14 successful, 0 failed
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 14 changes in database
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 06:58:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 06:58:35 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 06:58:35 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 07:04:44 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 07:04:44 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 07:04:44 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:04:45 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 07:04:45 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 07:04:47 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:04:47 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 07:04:47 WARN  [qtp1875388559-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 07:04:48 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm001: '2020-02-02'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm002: '2023-04-08'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm003: '2030-04-05'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm004: '1990-06-06'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm005: '2025-06-09'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm006: '2023-09-09'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0010: '2018-08-16'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0011: '2019-12-03'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0012: '2014-12-30'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0013: '2025-09-15'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0020: '2021-01-01'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm007: '2022-11-02'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0014: '2020-12-01'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2012-02-02'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2019-11-23'
2025-09-18 07:04:50 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ DUPLICATE admission number in row 16: adm0022
2025-09-18 07:04:50 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ⚠️  Found 1 duplicate records with 1 unique admission numbers: [adm0022]
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 15 rows (1 duplicates skipped)
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 14 new, 0 updated, 0 removed students, 0 duplicates ignored
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 14 changes in database
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 14 records in database
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2012-02-02'
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 9' to ID: de75dd39-9b5a-4f2a-9f6f-2e2a73740a65
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP1' to ID: c25ae18d-7ec6-4de5-b349-e4980e4176a5
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP2' to ID: a6366eec-69d9-4bbb-9c3e-c29f9b275d67
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 6' to ID: db92dfdc-e9eb-466b-b919-0bbf0c65d5d7
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:04:50 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 14 total, 14 successful, 0 failed
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 14 changes in database
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 07:04:50 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 07:04:50 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 07:04:50 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 07:05:40 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:05:44 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Excel file change detected, reloading data
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm001: '2020-02-02'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm002: '2023-04-08'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm003: '2030-04-05'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm004: '1990-06-06'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm005: '2025-06-09'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm006: '2023-09-09'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0010: '2018-08-16'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0011: '2019-12-03'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0012: '2014-12-30'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0013: '2025-09-15'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0020: '2021-01-01'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm007: '2022-11-02'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0014: '2020-12-01'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2012-02-02'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0023: '2019-11-23'
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ✅ Parsed 15 valid records from 15 rows (0 duplicates skipped)
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Read 15 learners from Excel file
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0023
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Change detection: 1 new, 0 updated, 0 removed students, 0 duplicates ignored
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Processing 1 changes in database
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Attempting to process 1 records in database
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer -   adm0023: '2019-11-23'
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm0023', fullName='Hailey Bailey', gradeName='Grade 1', dateJoinedSchool='2019-11-23', gender='Female', status=''}
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 07:05:45 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 07:05:45 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Resolved grade 'Grade 1' to ID: 9f02ec46-ef36-4ac4-98d5-92fe50a7612d
2025-09-18 07:05:46 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Import results: 1 total, 1 successful, 0 failed
2025-09-18 07:05:46 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 1 changes in database
2025-09-18 07:05:46 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Successfully processed 15 learners from Excel
2025-09-18 07:05:49 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:05:49 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:05:49 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:05:54 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:05:54 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:05:54 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:05:59 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:05:59 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:08:21 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Excel file change detected, reloading data
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm001: '2020-02-02'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm002: '2023-04-08'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm003: '2030-04-05'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm004: '1990-06-06'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm005: '2025-06-09'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm006: '2023-09-09'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0010: '2018-08-16'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0011: '2019-12-03'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0012: '2014-12-30'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0013: '2025-09-15'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0020: '2021-01-01'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm007: '2022-11-02'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0014: '2020-12-01'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2012-02-02'
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date string for adm0022: '2019-11-23'
2025-09-18 07:08:25 WARN  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ❌ DUPLICATE admission number in row 16: adm0022
2025-09-18 07:08:25 WARN  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ⚠️  Found 1 duplicate records with 1 unique admission numbers: [adm0022]
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 15 rows (1 duplicates skipped)
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 07:08:25 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: student_removed
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - REMOVED student detected: adm0023
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Change detection: 0 new, 0 updated, 1 removed students, 0 duplicates ignored
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - No database changes to process
2025-09-18 07:08:25 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 07:08:26 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:08:26 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:08:26 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:08:31 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:08:31 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:08:31 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:08:36 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:08:36 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:41:26 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 07:41:26 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 07:41:26 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:41:26 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 07:41:26 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:41:29 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 07:41:29 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:41:30 WARN  [qtp1537985199-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 07:41:30 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2020-02-02' normalized to '2020-02-02' for adm001
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2023-04-08' normalized to '2023-04-08' for adm002
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2030-04-05' normalized to '2030-04-05' for adm003
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '1990-06-06' normalized to '1990-06-06' for adm004
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2025-06-09' normalized to '2025-06-09' for adm005
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2023-09-09' normalized to '2023-09-09' for adm006
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2018-08-16' normalized to '2018-08-16' for adm0010
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2019-12-03' normalized to '2019-12-03' for adm0011
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2014-12-30' normalized to '2014-12-30' for adm0012
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2025-09-15' normalized to '2025-09-15' for adm0013
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2021-01-01' normalized to '2021-01-01' for adm0020
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2022-11-02' normalized to '2022-11-02' for adm007
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2020-12-01' normalized to '2020-12-01' for adm0014
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2012-02-02' normalized to '2012-02-02' for adm0022
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2019-11-23' normalized to '2019-11-23' for adm0022
2025-09-18 07:41:32 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ DUPLICATE admission number in row 16: adm0022 (already exists in row 15)
2025-09-18 07:41:32 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -    Existing: Mary Ann | New: Hailey Bailey
2025-09-18 07:41:32 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ⚠️  Found 1 duplicate records with 1 unique admission numbers: [adm0022]
2025-09-18 07:41:32 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -    Duplicate rows: [16]
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 15 rows (1 duplicates skipped)
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Validating 14 new learner records...
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 14 new, 0 updated, 0 removed, 0 duplicates, 0 invalid skipped
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 14 changes in database
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 14 records in database
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Cleaning up duplicate records in database for school: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:41:32 ERROR [JavaFX Application Thread] c.c.c.service.LearnerService - Error cleaning up database duplicates
org.postgresql.util.PSQLException: ERROR: function max(uuid) does not exist
  Hint: No function matches the given name and argument types. You might need to add explicit type casts.
  Position: 59
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.cleanupDuplicates(LearnerService.java:245)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.cleanupDatabaseDuplicates(ExcelSchoolServer.java:574)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.processChangesInDatabase(ExcelSchoolServer.java:588)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.detectChanges(ExcelSchoolServer.java:546)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelData(ExcelSchoolServer.java:213)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelDataWithRetryOnLock(ExcelSchoolServer.java:230)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:140)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:248)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:82)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Removed 0 duplicate records from database
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 07:41:32 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2012-02-02'
2025-09-18 07:41:32 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:41:33 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 07:41:33 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 9' to ID: de75dd39-9b5a-4f2a-9f6f-2e2a73740a65
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP1' to ID: c25ae18d-7ec6-4de5-b349-e4980e4176a5
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP2' to ID: a6366eec-69d9-4bbb-9c3e-c29f9b275d67
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 6' to ID: db92dfdc-e9eb-466b-b919-0bbf0c65d5d7
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:41:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:41:33 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 14 total, 14 successful, 0 failed
2025-09-18 07:41:33 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 14 changes in database
2025-09-18 07:41:33 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 07:41:33 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 07:41:33 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 07:41:33 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 07:42:08 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:42:50 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Excel file change detected, reloading data
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2020-02-02' normalized to '2020-02-02' for adm001
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2023-04-08' normalized to '2023-04-08' for adm002
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2030-04-05' normalized to '2030-04-05' for adm003
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '1990-06-06' normalized to '1990-06-06' for adm004
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2025-06-09' normalized to '2025-06-09' for adm005
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2023-09-09' normalized to '2023-09-09' for adm006
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2018-08-16' normalized to '2018-08-16' for adm0010
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2019-12-03' normalized to '2019-12-03' for adm0011
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2014-12-30' normalized to '2014-12-30' for adm0012
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2025-09-15' normalized to '2025-09-15' for adm0013
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2021-01-01' normalized to '2021-01-01' for adm0020
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2022-11-02' normalized to '2022-11-02' for adm007
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2020-12-01' normalized to '2020-12-01' for adm0014
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2012-02-02' normalized to '2012-02-02' for adm0022
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2019-11-23' normalized to '2019-11-23' for adm0022
2025-09-18 07:42:53 WARN  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ❌ DUPLICATE admission number in row 16: adm0022 (already exists in row 15)
2025-09-18 07:42:53 WARN  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer -    Existing: Mary Ann | New: Hailey Bailey
2025-09-18 07:42:53 WARN  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ⚠️  Found 1 duplicate records with 1 unique admission numbers: [adm0022]
2025-09-18 07:42:53 WARN  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer -    Duplicate rows: [16]
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ✅ Parsed 14 valid records from 15 rows (1 duplicates skipped)
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Read 14 learners from Excel file
2025-09-18 07:42:53 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Validating 14 new learner records...
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Change detection: 0 new, 0 updated, 0 removed, 0 duplicates, 0 invalid skipped
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - No database changes to process
2025-09-18 07:42:53 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Successfully processed 14 learners from Excel
2025-09-18 07:42:56 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:42:56 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:42:56 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:43:01 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:43:01 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:43:01 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:43:06 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:43:06 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:46:15 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Excel file change detected, reloading data
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2020-02-02' normalized to '2020-02-02' for adm001
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2023-04-08' normalized to '2023-04-08' for adm002
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2030-04-05' normalized to '2030-04-05' for adm003
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '1990-06-06' normalized to '1990-06-06' for adm004
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2025-06-09' normalized to '2025-06-09' for adm005
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2023-09-09' normalized to '2023-09-09' for adm006
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2018-08-16' normalized to '2018-08-16' for adm0010
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2019-12-03' normalized to '2019-12-03' for adm0011
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2014-12-30' normalized to '2014-12-30' for adm0012
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2025-09-15' normalized to '2025-09-15' for adm0013
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2021-01-01' normalized to '2021-01-01' for adm0020
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2022-11-02' normalized to '2022-11-02' for adm007
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2020-12-01' normalized to '2020-12-01' for adm0014
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2012-02-02' normalized to '2012-02-02' for adm0023
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date '2019-11-23' normalized to '2019-11-23' for adm0022
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ✅ Parsed 15 valid records from 15 rows (0 duplicates skipped)
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Read 15 learners from Excel file
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Validating 15 new learner records...
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0023
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: student_updated
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - UPDATED student detected: adm0022
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Change detection: 1 new, 1 updated, 0 removed, 0 duplicates, 0 invalid skipped
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Processing 2 changes in database
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Attempting to process 2 records in database
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Cleaning up duplicate records in database for school: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:46:18 ERROR [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Error cleaning up database duplicates
org.postgresql.util.PSQLException: ERROR: function max(uuid) does not exist
  Hint: No function matches the given name and argument types. You might need to add explicit type casts.
  Position: 59
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.cleanupDuplicates(LearnerService.java:245)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.cleanupDatabaseDuplicates(ExcelSchoolServer.java:574)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.processChangesInDatabase(ExcelSchoolServer.java:588)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.detectChanges(ExcelSchoolServer.java:546)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelData(ExcelSchoolServer.java:213)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelDataWithRetryOnLock(ExcelSchoolServer.java:230)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.checkForChanges(ExcelSchoolServer.java:644)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:358)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Removed 0 duplicate records from database
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer -   adm0023: '2012-02-02'
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer -   adm0022: '2019-11-23'
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm0023', fullName='Mary Ann', gradeName='Creche', dateJoinedSchool='2012-02-02', gender='Female', status=''}
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:46:18 DEBUG [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Resolved grade 'Grade 1' to ID: 9f02ec46-ef36-4ac4-98d5-92fe50a7612d
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.LearnerService - Import results: 2 total, 2 successful, 0 failed
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 2 changes in database
2025-09-18 07:46:18 INFO  [ExcelSchoolServer-Scheduler] c.c.c.service.ExcelSchoolServer - Successfully processed 15 learners from Excel
2025-09-18 07:46:20 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:46:20 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:46:20 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:46:25 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:46:25 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:46:25 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Excel file change detected via file system watcher
2025-09-18 07:46:30 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:46:30 DEBUG [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - No changes detected in Excel file
2025-09-18 07:47:31 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=ami userId=6a6860b5-5f9e-4e02-a037-581d998661f4 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 07:48:04 ERROR [Webhook-Service-Thread] c.c.c.service.WebhookService - Failed to start webhook service on port 8080
java.lang.IllegalStateException: This must be done before route mapping has begun
	at spark.core@2.9.4/spark.Service.throwBeforeRouteMappingException(Service.java:504)
	at spark.core@2.9.4/spark.Service.port(Service.java:169)
	at spark.core@2.9.4/spark.Spark.port(Spark.java:1014)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.configureServer(WebhookService.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:72)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.lambda$startWebhookService$5(Main.java:204)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 07:48:04 ERROR [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook service failed to start
java.lang.RuntimeException: Could not start webhook listener
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:78)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.lambda$startWebhookService$5(Main.java:204)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.IllegalStateException: This must be done before route mapping has begun
	at spark.core@2.9.4/spark.Service.throwBeforeRouteMappingException(Service.java:504)
	at spark.core@2.9.4/spark.Service.port(Service.java:169)
	at spark.core@2.9.4/spark.Spark.port(Spark.java:1014)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.configureServer(WebhookService.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:72)
	... 6 common frames omitted
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2020-02-02' normalized to '2020-02-02' for adm001
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2023-04-08' normalized to '2023-04-08' for adm002
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2030-04-05' normalized to '2030-04-05' for adm003
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '1990-06-06' normalized to '1990-06-06' for adm004
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2025-06-09' normalized to '2025-06-09' for adm005
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2023-09-09' normalized to '2023-09-09' for adm006
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2018-08-16' normalized to '2018-08-16' for adm0010
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2019-12-03' normalized to '2019-12-03' for adm0011
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2014-12-30' normalized to '2014-12-30' for adm0012
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2025-09-15' normalized to '2025-09-15' for adm0013
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2021-01-01' normalized to '2021-01-01' for adm0020
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2022-11-02' normalized to '2022-11-02' for adm007
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2020-12-01' normalized to '2020-12-01' for adm0014
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2012-02-02' normalized to '2012-02-02' for adm0023
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2019-11-23' normalized to '2019-11-23' for adm0022
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 15 valid records from 15 rows (0 duplicates skipped)
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 15 learners from Excel file
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Validating 15 new learner records...
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0023
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 15 new, 0 updated, 0 removed, 0 duplicates, 0 invalid skipped
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 15 changes in database
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 15 records in database
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Cleaning up duplicate records in database for school: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 07:48:04 ERROR [JavaFX Application Thread] c.c.c.service.LearnerService - Error cleaning up database duplicates
org.postgresql.util.PSQLException: ERROR: function max(uuid) does not exist
  Hint: No function matches the given name and argument types. You might need to add explicit type casts.
  Position: 59
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.cleanupDuplicates(LearnerService.java:245)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.cleanupDatabaseDuplicates(ExcelSchoolServer.java:574)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.processChangesInDatabase(ExcelSchoolServer.java:588)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.detectChanges(ExcelSchoolServer.java:546)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelData(ExcelSchoolServer.java:213)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelDataWithRetryOnLock(ExcelSchoolServer.java:230)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:140)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:248)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:82)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:193)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Removed 0 duplicate records from database
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0023: '2012-02-02'
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2019-11-23'
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 9' to ID: de75dd39-9b5a-4f2a-9f6f-2e2a73740a65
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP1' to ID: c25ae18d-7ec6-4de5-b349-e4980e4176a5
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP2' to ID: a6366eec-69d9-4bbb-9c3e-c29f9b275d67
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 6' to ID: db92dfdc-e9eb-466b-b919-0bbf0c65d5d7
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 07:48:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 1' to ID: 9f02ec46-ef36-4ac4-98d5-92fe50a7612d
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 15 total, 15 successful, 0 failed
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 15 changes in database
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 15 learners from Excel
2025-09-18 07:48:04 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 07:48:04 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 07:48:04 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 07:48:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:09:54 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 08:09:54 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=mw1 userId=6748e77d-a21d-4fee-94ad-a0532bd88c68 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 08:09:54 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:09:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 08:09:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 08:09:59 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 6748e77d-a21d-4fee-94ad-a0532bd88c68, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: true
2025-09-18 08:09:59 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Starting Excel School Server monitor for file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 🔄 Attempting to load Excel data from: C:\Users\user\Desktop\learners.xlsx
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - File changed detected, reading Excel data...
2025-09-18 08:09:59 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📖 Reading Excel file: C:\Users\user\Desktop\learners.xlsx
2025-09-18 08:10:01 WARN  [qtp811564390-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 08:10:01 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📊 Excel file has 16 rows
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📋 Headers: admission_number, full_name, grade_name, date_joined_school, gender
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2020-02-02' normalized to '2020-02-02' for adm001
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 1: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2023-04-08' normalized to '2023-04-08' for adm002
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 2: LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2030-04-05' normalized to '2030-04-05' for adm003
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - 📝 Record 3: LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '1990-06-06' normalized to '1990-06-06' for adm004
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2025-06-09' normalized to '2025-06-09' for adm005
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2023-09-09' normalized to '2023-09-09' for adm006
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2018-08-16' normalized to '2018-08-16' for adm0010
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2019-12-03' normalized to '2019-12-03' for adm0011
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2014-12-30' normalized to '2014-12-30' for adm0012
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2025-09-15' normalized to '2025-09-15' for adm0013
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2021-01-01' normalized to '2021-01-01' for adm0020
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2022-11-02' normalized to '2022-11-02' for adm007
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2020-12-01' normalized to '2020-12-01' for adm0014
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2012-02-02' normalized to '2012-02-02' for adm0023
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date '2019-11-23' normalized to '2019-11-23' for adm0022
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Parsed 15 valid records from 15 rows (0 duplicates skipped)
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Read 15 learners from Excel file
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample records: [LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}, LearnerRecord{admissionNumber='adm002', fullName='John Hamisi', gradeName='Grade 9', dateJoinedSchool='2023-04-08', gender='Male', status=''}, LearnerRecord{admissionNumber='adm003', fullName='Nicole Prudence', gradeName='Creche', dateJoinedSchool='2030-04-05', gender='Female', status=''}]
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Validating 15 new learner records...
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm001
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm002
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm003
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm004
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm005
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm006
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0010
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0011
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0012
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0013
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0020
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm007
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0014
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0023
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Skipping webhook for local operation: new_student
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - NEW student detected: adm0022
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Change detection: 15 new, 0 updated, 0 removed, 0 duplicates, 0 invalid skipped
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Processing 15 changes in database
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Attempting to process 15 records in database
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Cleaning up duplicate records in database for school: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:10:03 ERROR [JavaFX Application Thread] c.c.c.service.LearnerService - Error cleaning up database duplicates
org.postgresql.util.PSQLException: ERROR: function max(uuid) does not exist
  Hint: No function matches the given name and argument types. You might need to add explicit type casts.
  Position: 59
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.LearnerService.cleanupDuplicates(LearnerService.java:246)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.cleanupDatabaseDuplicates(ExcelSchoolServer.java:586)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.processChangesInDatabase(ExcelSchoolServer.java:606)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.detectChanges(ExcelSchoolServer.java:558)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelData(ExcelSchoolServer.java:225)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.loadExcelDataWithRetryOnLock(ExcelSchoolServer.java:242)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:152)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Removed 0 duplicate records from database
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Raw date strings from Excel:
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm001: '2020-02-02'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm002: '2023-04-08'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm003: '2030-04-05'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm004: '1990-06-06'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm005: '2025-06-09'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm006: '2023-09-09'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0010: '2018-08-16'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0011: '2019-12-03'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0012: '2014-12-30'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0013: '2025-09-15'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0020: '2021-01-01'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm007: '2022-11-02'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0014: '2020-12-01'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0023: '2012-02-02'
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   adm0022: '2019-11-23'
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Sample record for DB processing: LearnerRecord{admissionNumber='adm001', fullName='Michael Prince', gradeName='Grade 2', dateJoinedSchool='2020-02-02', gender='Male', status=''}
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - School validation: OK - School: main campus
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Found 12 grades for school
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 9' to ID: de75dd39-9b5a-4f2a-9f6f-2e2a73740a65
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP1' to ID: c25ae18d-7ec6-4de5-b349-e4980e4176a5
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'PP2' to ID: a6366eec-69d9-4bbb-9c3e-c29f9b275d67
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 7' to ID: 340eeac6-834d-48f0-9f57-eff401c9a203
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 2' to ID: 75c082f5-16ef-420e-8ca5-3635ca784401
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 8' to ID: 499620a9-9695-4ecd-9a80-9ac576c1a882
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 6' to ID: db92dfdc-e9eb-466b-b919-0bbf0c65d5d7
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Creche' to ID: 6804fc9b-5cb1-45bb-9e10-abe8c6fd195b
2025-09-18 08:10:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - Resolved grade 'Grade 1' to ID: 9f02ec46-ef36-4ac4-98d5-92fe50a7612d
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.LearnerService - Import results: 15 total, 15 successful, 0 failed
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ✅ Successfully processed 15 changes in database
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Successfully processed 15 learners from Excel
2025-09-18 08:10:03 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server started successfully
2025-09-18 08:10:03 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 08:10:03 INFO  [Excel-File-Watcher] c.c.c.service.ExcelSchoolServer - Watching directory for Excel file changes: C:\Users\user\Desktop
2025-09-18 08:10:28 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 08:10:42 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=ami userId=6a6860b5-5f9e-4e02-a037-581d998661f4 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 08:10:42 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 08:10:42 ERROR [Webhook-Service-Thread] c.c.c.service.WebhookService - Failed to start webhook service on port 8080
java.lang.IllegalStateException: This must be done before route mapping has begun
	at spark.core@2.9.4/spark.Service.throwBeforeRouteMappingException(Service.java:504)
	at spark.core@2.9.4/spark.Service.port(Service.java:169)
	at spark.core@2.9.4/spark.Spark.port(Spark.java:1014)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.configureServer(WebhookService.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:72)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.lambda$startWebhookService$5(Main.java:205)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 08:10:42 ERROR [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook service failed to start
java.lang.RuntimeException: Could not start webhook listener
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:78)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.lambda$startWebhookService$5(Main.java:205)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.IllegalStateException: This must be done before route mapping has begun
	at spark.core@2.9.4/spark.Service.throwBeforeRouteMappingException(Service.java:504)
	at spark.core@2.9.4/spark.Service.port(Service.java:169)
	at spark.core@2.9.4/spark.Spark.port(Spark.java:1014)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.configureServer(WebhookService.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:72)
	... 6 common frames omitted
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 08:10:42 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 6a6860b5-5f9e-4e02-a037-581d998661f4, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 08:10:42 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:193)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 08:10:42 ERROR [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ ACCESS DENIED: Only active coordinators can import Excel files
2025-09-18 08:10:42 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 08:10:42 WARN  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - User attempted Excel import without proper permissions. User role: club_coordinator, Active coordinator: false
2025-09-18 08:10:54 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:35:07 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 08:35:07 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=ami userId=6a6860b5-5f9e-4e02-a037-581d998661f4 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=club_coordinator
2025-09-18 08:35:07 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:35:07 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 08:35:07 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 08:35:09 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 08:35:09 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 08:35:09 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 08:35:09 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 08:35:09 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 08:35:09 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 08:35:09 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 6a6860b5-5f9e-4e02-a037-581d998661f4, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 08:35:10 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 08:35:10 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ User not authorized to import Excel - failing silently
2025-09-18 08:35:10 WARN  [JavaFX Application Thread] c.c.c.controller.LoginController - Unknown role 'club_coordinator', redirecting to coordinator dashboard
2025-09-18 08:35:10 WARN  [qtp317026688-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 08:35:11 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 08:36:02 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:36:50 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 08:37:17 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=pam userId=5858b2a0-a8b6-40f6-9e14-ef50ba3071f0 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=teacher
2025-09-18 08:37:17 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 08:37:17 ERROR [Webhook-Service-Thread] c.c.c.service.WebhookService - Failed to start webhook service on port 8080
java.lang.IllegalStateException: This must be done before route mapping has begun
	at spark.core@2.9.4/spark.Service.throwBeforeRouteMappingException(Service.java:504)
	at spark.core@2.9.4/spark.Service.port(Service.java:169)
	at spark.core@2.9.4/spark.Spark.port(Spark.java:1014)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.configureServer(WebhookService.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:72)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.lambda$startWebhookService$5(Main.java:205)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 08:37:17 ERROR [Webhook-Service-Thread] com.cms.clubmanagementsystem.Main - Webhook service failed to start
java.lang.RuntimeException: Could not start webhook listener
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:78)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.lambda$startWebhookService$5(Main.java:205)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:572)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:317)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)
Caused by: java.lang.IllegalStateException: This must be done before route mapping has begun
	at spark.core@2.9.4/spark.Service.throwBeforeRouteMappingException(Service.java:504)
	at spark.core@2.9.4/spark.Service.port(Service.java:169)
	at spark.core@2.9.4/spark.Spark.port(Spark.java:1014)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.configureServer(WebhookService.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.WebhookService.start(WebhookService.java:72)
	... 6 common frames omitted
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 5858b2a0-a8b6-40f6-9e14-ef50ba3071f0, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 08:37:17 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:193)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 08:37:17 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ User not authorized to import Excel - failing silently
2025-09-18 08:37:33 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:37:48 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:38:05 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 08:39:36 WARN  [qtp317026688-61] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 08:39:36 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Successfully unregistered webhook from school server
2025-09-18 08:39:36 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook service stopped
2025-09-18 08:39:36 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 08:39:36 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 19:37:54 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 19:37:55 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=pam userId=5858b2a0-a8b6-40f6-9e14-ef50ba3071f0 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=teacher
2025-09-18 19:37:55 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 19:37:58 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 19:37:58 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 19:38:05 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 19:38:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 19:38:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 19:38:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 19:38:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 19:38:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 19:38:06 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 5858b2a0-a8b6-40f6-9e14-ef50ba3071f0, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 19:38:06 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 19:38:06 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ User not authorized to import Excel - failing silently
2025-09-18 19:38:07 WARN  [qtp197731576-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 19:38:08 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 19:42:53 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 19:44:18 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 19:56:58 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 19:57:08 ERROR [JavaFX Application Thread] c.c.c.c.EnrollmentController - Error loading enrollments for term 1 year 2025
org.postgresql.util.PSQLException: ERROR: column l.first_name does not exist
  Position: 14
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:137)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeQuery(ProxyPreparedStatement.java:52)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeQuery(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.EnrollmentService.getEnrollmentsByClub(EnrollmentService.java:124)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.EnrollmentController.loadEnrollmentsForTerm(EnrollmentController.java:415)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.EnrollmentController.loadEnrollments(EnrollmentController.java:270)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.EnrollmentController.handleRefresh(EnrollmentController.java:521)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1855)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoopImpl(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoop(WinApplication.java:212)
	at javafx.graphics@21.0.2/com.sun.glass.ui.Application.enterNestedEventLoop(Application.java:515)
	at javafx.graphics@21.0.2/com.sun.glass.ui.EventLoop.enter(EventLoop.java:107)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.enterNestedEventLoop(QuantumToolkit.java:650)
	at javafx.graphics@21.0.2/javafx.stage.Stage.showAndWait(Stage.java:469)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.TeacherDashboardController.handleEnrollment(TeacherDashboardController.java:87)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1855)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:11:04 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 20:11:04 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=pam userId=5858b2a0-a8b6-40f6-9e14-ef50ba3071f0 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=teacher
2025-09-18 20:11:04 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:05 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 20:11:05 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 20:11:06 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 20:11:07 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 20:11:07 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 20:11:07 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 20:11:07 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 20:11:07 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 20:11:07 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 5858b2a0-a8b6-40f6-9e14-ef50ba3071f0, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 20:11:07 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:11:07 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ User not authorized to import Excel - failing silently
2025-09-18 20:11:08 WARN  [qtp106043360-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 20:11:08 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 20:11:17 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:43 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:43 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:43 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:46 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:46 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:46 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:49 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:52 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:57 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:57 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:11:57 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:12:01 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:12:01 ERROR [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Uncaught exception in JavaFX thread
java.lang.IndexOutOfBoundsException: [ fromIndex: 0, toIndex: 1, size: 0 ]
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.subList(ReadOnlyUnbackedObservableList.java:162)
	at javafx.base@21.0.2/javafx.collections.ListChangeListener$Change.getAddedSubList(ListChangeListener.java:243)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ListViewBehavior.lambda$new$57(ListViewBehavior.java:296)
	at javafx.base@21.0.2/javafx.collections.WeakListChangeListener.onChanged(WeakListChangeListener.java:88)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper$Generic.fireValueChangedEvent(ListListenerHelper.java:327)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper.fireValueChangedEvent(ListListenerHelper.java:71)
	at javafx.base@21.0.2/javafx.collections.ObservableListBase.fireChange(ObservableListBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.callObservers(ReadOnlyUnbackedObservableList.java:101)
	at javafx.controls@21.0.2/javafx.scene.control.MultipleSelectionModelBase.clearAndSelect(MultipleSelectionModelBase.java:394)
	at javafx.controls@21.0.2/javafx.scene.control.ListView$ListViewBitSetSelectionModel.clearAndSelect(ListView.java:1494)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.simpleSelect(CellBehaviorBase.java:287)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.doSelect(CellBehaviorBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.mousePressed(CellBehaviorBase.java:176)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoopImpl(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoop(WinApplication.java:212)
	at javafx.graphics@21.0.2/com.sun.glass.ui.Application.enterNestedEventLoop(Application.java:515)
	at javafx.graphics@21.0.2/com.sun.glass.ui.EventLoop.enter(EventLoop.java:107)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.enterNestedEventLoop(QuantumToolkit.java:650)
	at javafx.graphics@21.0.2/javafx.stage.Stage.showAndWait(Stage.java:469)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.TeacherDashboardController.handleEnrollment(TeacherDashboardController.java:87)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1855)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:12:01 ERROR [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Global exception handler caught error
java.lang.IndexOutOfBoundsException: [ fromIndex: 0, toIndex: 1, size: 0 ]
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.subList(ReadOnlyUnbackedObservableList.java:162)
	at javafx.base@21.0.2/javafx.collections.ListChangeListener$Change.getAddedSubList(ListChangeListener.java:243)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ListViewBehavior.lambda$new$57(ListViewBehavior.java:296)
	at javafx.base@21.0.2/javafx.collections.WeakListChangeListener.onChanged(WeakListChangeListener.java:88)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper$Generic.fireValueChangedEvent(ListListenerHelper.java:327)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper.fireValueChangedEvent(ListListenerHelper.java:71)
	at javafx.base@21.0.2/javafx.collections.ObservableListBase.fireChange(ObservableListBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.callObservers(ReadOnlyUnbackedObservableList.java:101)
	at javafx.controls@21.0.2/javafx.scene.control.MultipleSelectionModelBase.clearAndSelect(MultipleSelectionModelBase.java:394)
	at javafx.controls@21.0.2/javafx.scene.control.ListView$ListViewBitSetSelectionModel.clearAndSelect(ListView.java:1494)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.simpleSelect(CellBehaviorBase.java:287)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.doSelect(CellBehaviorBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.mousePressed(CellBehaviorBase.java:176)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoopImpl(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoop(WinApplication.java:212)
	at javafx.graphics@21.0.2/com.sun.glass.ui.Application.enterNestedEventLoop(Application.java:515)
	at javafx.graphics@21.0.2/com.sun.glass.ui.EventLoop.enter(EventLoop.java:107)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.enterNestedEventLoop(QuantumToolkit.java:650)
	at javafx.graphics@21.0.2/javafx.stage.Stage.showAndWait(Stage.java:469)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.TeacherDashboardController.handleEnrollment(TeacherDashboardController.java:87)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1855)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:31:35 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 20:31:35 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=pam userId=5858b2a0-a8b6-40f6-9e14-ef50ba3071f0 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=teacher
2025-09-18 20:31:35 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:31:36 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 20:31:36 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 20:31:37 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 20:31:37 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 20:31:37 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 20:31:37 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 20:31:37 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 20:31:37 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 20:31:37 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 5858b2a0-a8b6-40f6-9e14-ef50ba3071f0, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 20:31:38 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:31:38 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ User not authorized to import Excel - failing silently
2025-09-18 20:31:38 WARN  [qtp1951912816-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 20:31:39 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 20:31:52 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:14 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:14 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:14 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:16 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:16 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:19 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:32:19 ERROR [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Uncaught exception in JavaFX thread
java.lang.IndexOutOfBoundsException: [ fromIndex: 0, toIndex: 1, size: 0 ]
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.subList(ReadOnlyUnbackedObservableList.java:162)
	at javafx.base@21.0.2/javafx.collections.ListChangeListener$Change.getAddedSubList(ListChangeListener.java:243)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ListViewBehavior.lambda$new$57(ListViewBehavior.java:296)
	at javafx.base@21.0.2/javafx.collections.WeakListChangeListener.onChanged(WeakListChangeListener.java:88)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper$Generic.fireValueChangedEvent(ListListenerHelper.java:327)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper.fireValueChangedEvent(ListListenerHelper.java:71)
	at javafx.base@21.0.2/javafx.collections.ObservableListBase.fireChange(ObservableListBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.callObservers(ReadOnlyUnbackedObservableList.java:101)
	at javafx.controls@21.0.2/javafx.scene.control.MultipleSelectionModelBase.clearAndSelect(MultipleSelectionModelBase.java:394)
	at javafx.controls@21.0.2/javafx.scene.control.ListView$ListViewBitSetSelectionModel.clearAndSelect(ListView.java:1494)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.simpleSelect(CellBehaviorBase.java:287)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.doSelect(CellBehaviorBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.mousePressed(CellBehaviorBase.java:176)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoopImpl(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoop(WinApplication.java:212)
	at javafx.graphics@21.0.2/com.sun.glass.ui.Application.enterNestedEventLoop(Application.java:515)
	at javafx.graphics@21.0.2/com.sun.glass.ui.EventLoop.enter(EventLoop.java:107)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.enterNestedEventLoop(QuantumToolkit.java:650)
	at javafx.graphics@21.0.2/javafx.stage.Stage.showAndWait(Stage.java:469)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.TeacherDashboardController.handleEnrollment(TeacherDashboardController.java:87)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1855)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:32:19 ERROR [JavaFX Application Thread] com.cms.clubmanagementsystem.Main - Global exception handler caught error
java.lang.IndexOutOfBoundsException: [ fromIndex: 0, toIndex: 1, size: 0 ]
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.subList(ReadOnlyUnbackedObservableList.java:162)
	at javafx.base@21.0.2/javafx.collections.ListChangeListener$Change.getAddedSubList(ListChangeListener.java:243)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ListViewBehavior.lambda$new$57(ListViewBehavior.java:296)
	at javafx.base@21.0.2/javafx.collections.WeakListChangeListener.onChanged(WeakListChangeListener.java:88)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper$Generic.fireValueChangedEvent(ListListenerHelper.java:327)
	at javafx.base@21.0.2/com.sun.javafx.collections.ListListenerHelper.fireValueChangedEvent(ListListenerHelper.java:71)
	at javafx.base@21.0.2/javafx.collections.ObservableListBase.fireChange(ObservableListBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.callObservers(ReadOnlyUnbackedObservableList.java:101)
	at javafx.controls@21.0.2/javafx.scene.control.MultipleSelectionModelBase.clearAndSelect(MultipleSelectionModelBase.java:394)
	at javafx.controls@21.0.2/javafx.scene.control.ListView$ListViewBitSetSelectionModel.clearAndSelect(ListView.java:1494)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.simpleSelect(CellBehaviorBase.java:287)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.doSelect(CellBehaviorBase.java:246)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.CellBehaviorBase.mousePressed(CellBehaviorBase.java:176)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoopImpl(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._enterNestedEventLoop(WinApplication.java:212)
	at javafx.graphics@21.0.2/com.sun.glass.ui.Application.enterNestedEventLoop(Application.java:515)
	at javafx.graphics@21.0.2/com.sun.glass.ui.EventLoop.enter(EventLoop.java:107)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.enterNestedEventLoop(QuantumToolkit.java:650)
	at javafx.graphics@21.0.2/javafx.stage.Stage.showAndWait(Stage.java:469)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.TeacherDashboardController.handleEnrollment(TeacherDashboardController.java:87)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1855)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:53:31 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 20:53:31 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=pam userId=5858b2a0-a8b6-40f6-9e14-ef50ba3071f0 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=teacher
2025-09-18 20:53:31 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:53:31 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 20:53:31 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 20:53:34 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 20:53:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 20:53:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 20:53:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 20:53:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 20:53:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 20:53:35 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 5858b2a0-a8b6-40f6-9e14-ef50ba3071f0, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 20:53:35 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 20:53:35 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ User not authorized to import Excel - failing silently
2025-09-18 20:53:36 WARN  [qtp1363803826-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 20:53:37 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 20:53:43 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:54:12 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:54:16 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 20:54:16 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 21:02:55 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 21:02:55 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Session created for username=pam userId=5858b2a0-a8b6-40f6-9e14-ef50ba3071f0 schoolId=9d47203f-4e54-47ac-a560-eeb277794e76 schoolName=main campus role=teacher
2025-09-18 21:02:55 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 21:02:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook HMAC validation enabled
2025-09-18 21:02:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook API authentication enabled
2025-09-18 21:02:57 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - Excel School Server initialized:
2025-09-18 21:02:57 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   File: C:\Users\user\Desktop\learners.xlsx
2025-09-18 21:02:57 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Webhook URL: http://localhost:8080/webhook
2025-09-18 21:02:57 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   HMAC Signature: ENABLED
2025-09-18 21:02:57 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer -   Lock retry settings: 5 attempts with 3000ms delay
2025-09-18 21:02:57 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Webhook service started successfully on port 8080 - Authentication: true
2025-09-18 21:02:57 INFO  [JavaFX Application Thread] c.c.c.utils.SessionManager - Excel import attempted by user: 5858b2a0-a8b6-40f6-9e14-ef50ba3071f0, school: 9d47203f-4e54-47ac-a560-eeb277794e76, authorized: false
2025-09-18 21:02:57 ERROR [JavaFX Application Thread] c.c.c.utils.SessionManager - Failed to log audit entry
org.postgresql.util.PSQLException: ERROR: relation "audit_log" does not exist
  Position: 13
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2725)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2412)
	at org.postgresql.jdbc@42.7.3/org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:371)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:502)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgStatement.execute(PgStatement.java:419)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:194)
	at org.postgresql.jdbc@42.7.3/org.postgresql.jdbc.PgPreparedStatement.executeUpdate(PgPreparedStatement.java:155)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.ProxyPreparedStatement.executeUpdate(ProxyPreparedStatement.java:61)
	at com.zaxxer.hikari@5.1.0/com.zaxxer.hikari.pool.HikariProxyPreparedStatement.executeUpdate(HikariProxyPreparedStatement.java)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logToAuditTable(SessionManager.java:349)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.utils.SessionManager.logImportAttempt(SessionManager.java:336)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.service.ExcelSchoolServer.start(ExcelSchoolServer.java:139)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.startExcelSchoolServer(Main.java:249)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.Main.onSchoolLogin(Main.java:83)
	at com.cms.clubmanagementsystem/com.cms.clubmanagementsystem.controller.LoginController.handleLogin(LoginController.java:188)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at com.sun.javafx.reflect.Trampoline.invoke(MethodUtil.java:72)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at javafx.base@21.0.2/com.sun.javafx.reflect.MethodUtil.invoke(MethodUtil.java:270)
	at javafx.fxml@21.0.2/com.sun.javafx.fxml.MethodHelper.invoke(MethodHelper.java:84)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$MethodHandler.invoke(FXMLLoader.java:1853)
	at javafx.fxml@21.0.2/javafx.fxml.FXMLLoader$ControllerMethodEventHandler.handle(FXMLLoader.java:1726)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:86)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:49)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Node.fireEvent(Node.java:8875)
	at javafx.controls@21.0.2/javafx.scene.control.Button.fire(Button.java:203)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.behavior.ButtonBehavior.mouseReleased(ButtonBehavior.java:207)
	at javafx.controls@21.0.2/com.sun.javafx.scene.control.inputmap.InputMap.handle(InputMap.java:274)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler$NormalEventHandlerRecord.handleBubblingEvent(CompositeEventHandler.java:247)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventHandler.dispatchBubblingEvent(CompositeEventHandler.java:80)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:232)
	at javafx.base@21.0.2/com.sun.javafx.event.EventHandlerManager.dispatchBubblingEvent(EventHandlerManager.java:189)
	at javafx.base@21.0.2/com.sun.javafx.event.CompositeEventDispatcher.dispatchBubblingEvent(CompositeEventDispatcher.java:59)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:58)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.BasicEventDispatcher.dispatchEvent(BasicEventDispatcher.java:56)
	at javafx.base@21.0.2/com.sun.javafx.event.EventDispatchChainImpl.dispatchEvent(EventDispatchChainImpl.java:114)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEventImpl(EventUtil.java:74)
	at javafx.base@21.0.2/com.sun.javafx.event.EventUtil.fireEvent(EventUtil.java:54)
	at javafx.base@21.0.2/javafx.event.Event.fireEvent(Event.java:198)
	at javafx.graphics@21.0.2/javafx.scene.Scene$MouseHandler.process(Scene.java:3984)
	at javafx.graphics@21.0.2/javafx.scene.Scene.processMouseEvent(Scene.java:1890)
	at javafx.graphics@21.0.2/javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2708)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:411)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:301)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:400)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:450)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:424)
	at javafx.graphics@21.0.2/com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:449)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.handleMouseEvent(View.java:551)
	at javafx.graphics@21.0.2/com.sun.glass.ui.View.notifyMouse(View.java:937)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication._runLoop(Native Method)
	at javafx.graphics@21.0.2/com.sun.glass.ui.win.WinApplication.lambda$runLoop$3(WinApplication.java:185)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-18 21:02:57 INFO  [JavaFX Application Thread] c.c.c.service.ExcelSchoolServer - ❌ User not authorized to import Excel - failing silently
2025-09-18 21:02:58 WARN  [qtp1580892881-50] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 21:02:58 INFO  [Webhook-Service-Thread] c.c.c.service.WebhookService - Successfully registered webhook with school server
2025-09-18 21:03:03 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 21:03:15 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 21:03:15 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 21:03:20 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 21:03:20 DEBUG [JavaFX Application Thread] c.c.c.service.LearnerService - LearnerService initialized for school ID: 9d47203f-4e54-47ac-a560-eeb277794e76
2025-09-18 21:04:55 WARN  [qtp1580892881-57] c.c.c.service.WebhookService - Unauthorized webhook attempt - missing API key from IP: 127.0.0.1, User-Agent: Java-http-client/21.0.7
2025-09-18 21:04:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Successfully unregistered webhook from school server
2025-09-18 21:04:55 INFO  [JavaFX Application Thread] c.c.c.service.WebhookService - Webhook service stopped
2025-09-18 21:04:55 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
2025-09-18 21:04:55 DEBUG [JavaFX Application Thread] c.c.c.utils.SessionManager - All transient data cleared.
