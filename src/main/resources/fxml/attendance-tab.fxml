<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<ScrollPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.cms.clubmanagementsystem.controller.AttendanceTabController"
            fitToWidth="true" style="-fx-background: #f8f9fa;">

    <VBox spacing="20" style="-fx-padding: 25;">

        <!-- Header Section -->
        <Label text="Attendance Management" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;">
            <padding>
                <Insets bottom="10" />
            </padding>
        </Label>

        <!-- Control Panel -->
        <VBox spacing="15" style="-fx-background-color: white; -fx-padding: 20; -fx-border-color: #e0e0e0; -fx-border-radius: 8; -fx-background-radius: 8;">
            <Label text="Filters &amp; Actions" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #34495e;"/>

            <!-- Filter Row -->
            <HBox spacing="20" alignment="CENTER_LEFT">
                <VBox spacing="5">
                    <Label text="Year" style="-fx-font-weight: bold; -fx-text-fill: #555;"/>
                    <ComboBox fx:id="yearComboBox" prefWidth="140"/>
                </VBox>

                <VBox spacing="5">
                    <Label text="Month" style="-fx-font-weight: bold; -fx-text-fill: #555;"/>
                    <ComboBox fx:id="monthComboBox" prefWidth="160"/>
                </VBox>

                <Region HBox.hgrow="ALWAYS"/>

                <VBox spacing="5">
                    <Label text="Quick Actions" style="-fx-font-weight: bold; -fx-text-fill: #555;"/>
                    <HBox spacing="15" alignment="CENTER_RIGHT">
                        <Button text="Refresh" onAction="#handleRefresh"
                                style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-weight: bold; -fx-min-width: 100; -fx-pref-height: 40;"/>
                        <Button text="Take Attendance" onAction="#handleTakeAttendance"
                                style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-min-width: 140; -fx-pref-height: 40;"/>
                    </HBox>
                </VBox>
            </HBox>

            <!-- Export Buttons Row -->
            <HBox spacing="15" alignment="CENTER_RIGHT">
                <Button text="Export All Data" onAction="#handleExportAttendance"
                        style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold; -fx-min-width: 140; -fx-pref-height: 40;"/>
                <Button text="Export Selected Session" onAction="#handleExportSession"
                        style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-weight: bold; -fx-min-width: 170; -fx-pref-height: 40;"/>
            </HBox>
        </VBox>

        <!-- Summary Section -->
        <VBox spacing="10" style="-fx-background-color: #e8f4fd; -fx-padding: 15; -fx-border-color: #3498db; -fx-border-radius: 6; -fx-background-radius: 6;">
            <Label fx:id="summaryLabel" style="-fx-font-weight: bold; -fx-text-fill: #2c3e50; -fx-wrap-text: true;"/>
            <Label fx:id="sessionDetailsLabel" style="-fx-text-fill: #7f8c8d; -fx-font-style: italic; -fx-wrap-text: true;"/>
        </VBox>

        <!-- Data Section -->
        <VBox spacing="0" VBox.vgrow="ALWAYS" style="-fx-background-color: white; -fx-border-color: #e0e0e0; -fx-border-radius: 6; -fx-background-radius: 6;">

            <!-- Sessions Section -->
            <VBox spacing="10" style="-fx-padding: 20; -fx-border-color: #e0e0e0; -fx-border-width: 0 0 1 0;">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Attendance Sessions" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Label text="Click on a session to view details" style="-fx-text-fill: #7f8c8d; -fx-font-size: 12px;"/>
                </HBox>
                <TableView fx:id="sessionsTable" prefHeight="250" style="-fx-border-color: #e0e0e0;">
                    <columns>
                        <TableColumn fx:id="dateColumn" text="Session Date" prefWidth="150" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="timeColumn" text="Time Range" prefWidth="160" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="presentColumn" text="Present" prefWidth="100" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="absentColumn" text="Absent" prefWidth="100" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="totalColumn" text="Total" prefWidth="100" style="-fx-alignment: CENTER;"/>
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                    </columnResizePolicy>
                </TableView>
            </VBox>

            <!-- Attendance Records Section with Pagination -->
            <VBox spacing="10" style="-fx-padding: 20;">
                <HBox alignment="CENTER_LEFT" spacing="10">
                    <Label text="Attendance Records" style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #2c3e50;"/>
                    <Region HBox.hgrow="ALWAYS"/>

                    <!-- Pagination Controls -->
                    <HBox spacing="10" alignment="CENTER_RIGHT">
                        <Button fx:id="previousPageButton" text="◀ Previous" onAction="#handlePreviousPage"
                                style="-fx-background-color: #bdc3c7; -fx-text-fill: white; -fx-font-weight: bold; -fx-min-width: 100; -fx-pref-height: 35;"/>
                        <Label fx:id="pageInfoLabel" style="-fx-text-fill: #7f8c8d; -fx-font-weight: bold; -fx-padding: 0 15;"/>
                        <Button fx:id="nextPageButton" text="Next ▶" onAction="#handleNextPage"
                                style="-fx-background-color: #bdc3c7; -fx-text-fill: white; -fx-font-weight: bold; -fx-min-width: 100; -fx-pref-height: 35;"/>
                    </HBox>
                </HBox>

                <TableView fx:id="attendanceTable" prefHeight="300" style="-fx-border-color: #e0e0e0;">
                    <columns>
                        <TableColumn fx:id="learnerNameColumn" text="Learner Name" prefWidth="280"/>
                        <TableColumn fx:id="gradeColumn" text="Grade" prefWidth="120" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="statusColumn" text="Status" prefWidth="120" style="-fx-alignment: CENTER;"/>
                        <TableColumn fx:id="sessionDateColumn" text="Session Date" prefWidth="150" style="-fx-alignment: CENTER;"/>
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                    </columnResizePolicy>
                </TableView>
            </VBox>

        </VBox>

    </VBox>
</ScrollPane>